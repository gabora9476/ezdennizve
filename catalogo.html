<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Astral Boutique</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <link rel="icon" href="https://i.imgur.com/4L6X5Qj.png" type="image/png">
    
    <style>
        :root {
            /* Variables Base (Se actualizan con JS desde el Admin) */
            --primary-color: #d4af37;
            --accent-color: #ff007f;
            --bg-dark: #050505;
            
            /* Variables Computadas */
            --dynamic-bg: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            --dynamic-text: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            
            /* Sistema Glassmorphism */
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-blur: blur(16px);
            --text-main: #ffffff;
            --text-muted: #a0a0a0;
            --radius: 16px;
        }

        /* --- UI GLOBAL & ANTI-ROBO --- */
        body { 
            -webkit-user-select: none; /* Chrome/Safari */        
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE10+ */
            user-select: none; /* Standard */
            
            background-color: var(--bg-dark); 
            color: var(--text-main); 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            margin: 0; 
            padding: 0; 
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
            transition: background-color 0.3s;
        }
        
        img { 
            pointer-events: none; /* Evita arrastrar imagen */ 
            -webkit-user-drag: none;
        }

        * { box-sizing: border-box; }

        /* --- ORBES DE FONDO --- */
        .background-orb { 
            position: fixed; 
            border-radius: 50%; 
            filter: blur(80px); 
            z-index: -1; 
            animation: floatOrb 10s infinite alternate; 
        }
        .orb-1 { 
            width: 300px; height: 300px; 
            background: var(--primary-color); 
            top: -50px; left: -50px; 
            opacity: 0.2; 
        }
        .orb-2 { 
            width: 250px; height: 250px; 
            background: var(--accent-color); 
            bottom: 10%; right: -50px; 
            opacity: 0.15; 
            animation-delay: -5s; 
        }

        @keyframes floatOrb { 
            from { transform: translate(0, 0); } 
            to { transform: translate(30px, 50px); } 
        }

        /* --- HEADER --- */
        header {
            background: rgba(5, 5, 5, 0.7);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            padding: 15px 25px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--glass-border);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-img {
            height: 32px;
            width: auto;
            filter: drop-shadow(0 0 3px var(--primary-color));
        }

        .logo-text { 
            font-size: 1.3rem; 
            font-weight: 600; 
            background: var(--dynamic-text); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .header-icons i { 
            font-size: 1.3rem; 
            margin-left: 20px; 
            color: #fff; 
            cursor: pointer; 
            transition: 0.3s; 
            pointer-events: auto; 
        }
        
        .header-icons i:hover { color: var(--primary-color); }
        
        .cart-count { 
            position: absolute; top: -5px; right: -8px; 
            background: var(--accent-color); 
            font-size: 0.65rem; padding: 2px 6px; 
            border-radius: 10px; font-weight: bold; 
            box-shadow: 0 0 10px var(--accent-color); 
        }

        /* --- CONTENEDOR PRINCIPAL --- */
        .container { 
            padding: 20px; 
            max-width: 1200px; 
            margin: 0 auto; 
            flex: 1; width: 100%; 
        }
        
        /* FILTROS */
        .filters { 
            display: flex; gap: 12px; 
            overflow-x: auto; padding-bottom: 15px; 
            margin-bottom: 10px; 
            scrollbar-width: none; pointer-events: auto; 
        }
        .filters::-webkit-scrollbar { display: none; }
        
        .filter-btn { 
            background: var(--glass-bg); 
            color: var(--text-muted); 
            border: 1px solid var(--glass-border); 
            padding: 10px 20px; border-radius: 30px; 
            white-space: nowrap; cursor: pointer; 
            transition: 0.3s; backdrop-filter: blur(5px);
            font-size: 0.9rem;
        }
        
        .filter-btn.active { 
            background: var(--dynamic-bg); 
            color: white; border: none; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); font-weight: 600;
        }

        /* GRID PRODUCTOS */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); 
            gap: 20px; 
        }
        
        .product-card { 
            background: var(--glass-bg); 
            border: 1px solid var(--glass-border); 
            border-radius: var(--radius); 
            overflow: hidden; position: relative; 
            transition: transform 0.3s, box-shadow 0.3s; 
            backdrop-filter: blur(5px); 
            cursor: pointer; pointer-events: auto;
        }
        
        .product-card:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); 
            border-color: var(--primary-color); 
        }
        .product-card:active { transform: scale(0.98); }
        
        .badge-new { 
            position: absolute; top: 10px; left: 10px; 
            background: var(--accent-color); color: white; 
            font-size: 0.6rem; padding: 4px 8px; 
            border-radius: 4px; z-index: 2; 
            font-weight: 700; letter-spacing: 1px; 
        }
        
        .img-container { 
            height: 200px; width: 100%; 
            overflow: hidden; position: relative; 
        }
        
        .img-container img { 
            width: 100%; height: 100%; 
            object-fit: cover; transition: 0.5s; 
        }
        .product-card:hover img { transform: scale(1.1); }
        
        .card-info { 
            padding: 15px; 
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); 
            position: absolute; bottom: 0; width: 100%; 
        }
        
        .card-title { 
            font-size: 0.95rem; margin-bottom: 5px; 
            white-space: nowrap; overflow: hidden; 
            text-overflow: ellipsis; font-weight: 600; 
        }
        
        .card-price { 
            color: var(--primary-color); 
            font-weight: 700; font-size: 1.1rem; 
        }

        /* --- FOOTER --- */
        footer {
            margin-top: auto; border-top: 1px solid var(--glass-border); 
            padding: 30px 20px; background: rgba(0,0,0,0.6); 
            backdrop-filter: blur(10px); text-align: center;
        }
        
        .social-icons { 
            display: flex; justify-content: center; gap: 20px; 
            margin-bottom: 15px; pointer-events: auto; 
        }
        
        .social-btn { 
            width: 45px; height: 45px; border-radius: 50%; 
            background: rgba(255,255,255,0.05); 
            display: flex; align-items: center; justify-content: center; 
            color: white; font-size: 1.3rem; 
            text-decoration: none; transition: 0.3s; 
            border: 1px solid var(--glass-border);
        }
        
        .social-btn:hover { 
            border-color: var(--primary-color); color: var(--primary-color); 
            transform: translateY(-5px); background: rgba(255,255,255,0.1); 
        }
        
        .copyright { font-size: 0.8rem; color: #888; }
        .powered-by { 
            font-size: 0.75rem; color: var(--primary-color); 
            margin-top: 5px; opacity: 0.8; 
            letter-spacing: 1px; font-weight: 300; 
        }

        /* --- MODALES --- */
        .modal { 
            display: none; position: fixed; top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); z-index: 1000; 
            justify-content: center; align-items: center; 
            backdrop-filter: blur(8px); 
        }
        .modal.active { display: flex; animation: fadeIn 0.3s forwards; }
        
        .modal-content { 
            background: rgba(15, 15, 15, 0.95); 
            width: 100%; border-radius: 25px; 
            padding: 25px; max-height: 90vh; 
            overflow-y: auto; position: relative; 
            border: 1px solid var(--glass-border); 
            box-shadow: 0 0 50px rgba(0,0,0,0.7); max-width: 500px;
        }
        
        .close-modal { 
            position: absolute; top: 15px; right: 15px; 
            background: rgba(255,255,255,0.1); border: none; 
            color: white; width: 30px; height: 30px; 
            border-radius: 50%; cursor: pointer; 
            display: flex; align-items: center; justify-content: center; 
            transition: 0.3s; z-index: 10; pointer-events: auto; 
        }
        .close-modal:hover { background: var(--accent-color); transform: rotate(90deg); }

        /* --- MODAL PRODUCTO COMPACTO --- */
        .modal-body-compact { display: flex; gap: 15px; margin-bottom: 15px; }
        
        .modal-img-wrapper { 
            position: relative; width: 100px; height: 100px; 
            flex-shrink: 0; 
        }
        
        .modal-img-compact { 
            width: 100%; height: 100%; 
            border-radius: 12px; object-fit: cover; 
            border: 1px solid var(--glass-border); 
            cursor: zoom-in; pointer-events: auto; 
        }
        
        .zoom-hint { 
            position: absolute; bottom: 5px; right: 5px; 
            background: rgba(0,0,0,0.6); color: white; 
            font-size: 0.6rem; padding: 2px 5px; 
            border-radius: 4px; pointer-events: none; 
        }
        
        .modal-details-compact { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .modal-title { font-size: 1rem; font-weight: 600; line-height: 1.2; margin-bottom: 5px; }
        .modal-price { color: var(--primary-color); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .modal-desc { font-size: 0.75rem; color: #aaa; margin-bottom: 5px; line-height: 1.3; max-height: 50px; overflow-y: auto; }
        
        .attr-group { margin-bottom: 10px; }
        .attr-label { font-size: 0.7rem; color: #666; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
        .attr-chips-container { display: flex; flex-wrap: wrap; gap: 8px; }
        
        .option-chip { 
            border: 1px solid rgba(255,255,255,0.15); 
            padding: 5px 12px; border-radius: 8px; 
            cursor: pointer; font-size: 0.8rem; 
            background: rgba(255,255,255,0.02); 
            transition: 0.3s; pointer-events: auto; 
        }
        .option-chip.selected { 
            border-color: var(--primary-color); 
            background: rgba(212, 175, 55, 0.15); 
            color: var(--primary-color); 
            box-shadow: 0 0 5px rgba(212, 175, 55, 0.2); 
        }

        /* --- GALER√çA FULLSCREEN --- */
        .gallery-modal { 
            position: fixed; top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: #000; z-index: 5000; 
            display: none; flex-direction: column; 
            justify-content: center; align-items: center; 
        }
        .gallery-modal.active { display: flex; animation: fadeIn 0.3s forwards; }
        
        .gallery-img-container { 
            width: 100%; height: 70%; 
            display: flex; justify-content: center; align-items: center; 
            position: relative; 
        }
        .gallery-img { max-width: 100%; max-height: 100%; object-fit: contain; pointer-events: none; }
        
        .gallery-controls { 
            position: absolute; bottom: 50px; 
            display: flex; align-items: center; gap: 20px; 
            pointer-events: auto; 
        }
        .gallery-btn { 
            background: rgba(255,255,255,0.1); 
            border: none; color: white; 
            width: 50px; height: 50px; 
            border-radius: 50%; font-size: 1.2rem; 
            cursor: pointer; display: flex; align-items: center; 
            justify-content: center; 
        }
        .gallery-dots { display: flex; gap: 8px; }
        .dot { width: 8px; height: 8px; border-radius: 50%; background: #555; transition: 0.3s; }
        .dot.active { background: var(--primary-color); transform: scale(1.2); }
        .gallery-close { 
            position: absolute; top: 20px; right: 20px; 
            color: white; font-size: 2rem; cursor: pointer; 
            z-index: 5001; pointer-events: auto; 
        }

        /* --- UI COMPONENTES --- */
        .btn-primary { 
            width: 100%; background: var(--dynamic-bg); border: none; 
            padding: 14px; border-radius: 12px; color: white; 
            font-weight: 600; font-size: 1rem; margin-top: 10px; 
            cursor: pointer; box-shadow: 0 5px 20px rgba(0,0,0,0.3); 
            transition: 0.3s; pointer-events: auto; 
        }
        .btn-primary:active { transform: scale(0.98); }
        
        .btn-secondary { 
            background: rgba(255,255,255,0.1); color: white; 
            border: 1px solid rgba(255,255,255,0.05); 
            padding: 12px; border-radius: 10px; width: 100%; 
            margin-top: 10px; cursor: pointer; pointer-events: auto; 
        }
        
        .input-glass { 
            width: 100%; padding: 14px; 
            background: rgba(0,0,0,0.3); 
            border: 1px solid var(--glass-border); 
            color: white; border-radius: 10px; 
            margin-bottom: 12px; outline: none; 
            transition: 0.3s; pointer-events: auto; 
        }
        .input-glass:focus { border-color: var(--primary-color); background: rgba(0,0,0,0.5); }

        /* --- ADMIN STYLES --- */
        .admin-tabs { 
            display: flex; gap: 5px; margin-bottom: 20px; 
            background: rgba(0,0,0,0.3); padding: 5px; 
            border-radius: 12px; pointer-events: auto; 
        }
        .tab { 
            flex: 1; padding: 10px; text-align: center; 
            cursor: pointer; color: var(--text-muted); 
            border-radius: 8px; transition: 0.3s; font-size: 0.9rem; 
        }
        .tab.active { background: rgba(255,255,255,0.1); color: var(--primary-color); font-weight: bold; }
        
        .upload-area { 
            border: 2px dashed rgba(255,255,255,0.2); 
            padding: 20px; text-align: center; 
            border-radius: 12px; margin-bottom: 15px; 
            cursor: pointer; transition: 0.3s; pointer-events: auto; 
        }
        .upload-area:hover { border-color: var(--primary-color); background: rgba(255,255,255,0.02); }
        
        .color-config-row { 
            display: flex; align-items: center; 
            justify-content: space-between; margin-bottom: 10px; 
            padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px; 
        }
        .color-input { border: none; width: 40px; height: 40px; cursor: pointer; background: none; pointer-events: auto; }
        
        .social-config-row { 
            display: flex; align-items: center; gap: 10px; 
            margin-bottom: 10px; background: rgba(255,255,255,0.03); 
            padding: 8px; border-radius: 8px; 
        }
        .social-config-row i { width: 30px; text-align: center; color: var(--text-muted); }
        .social-config-row input[type="text"] { margin: 0; flex: 1; }
        input[type="checkbox"] { pointer-events: auto; }

        .toast { 
            position: fixed; bottom: 20px; left: 50%; 
            transform: translateX(-50%); background: rgba(20,20,20,0.9); 
            backdrop-filter: blur(10px); border: 1px solid var(--glass-border); 
            color: white; padding: 12px 25px; border-radius: 30px; 
            font-size: 0.9rem; opacity: 0; pointer-events: none; 
            transition: 0.3s; z-index: 2000; 
            display: flex; align-items: center; gap: 10px; 
            border: 1px solid var(--primary-color); 
        }
        .toast.show { opacity: 1; bottom: 40px; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="background-orb orb-1"></div>
    <div class="background-orb orb-2"></div>

    <header>
        <div class="logo-container">
            <img src="https://i.imgur.com/4L6X5Qj.png" alt="Astral Logo" class="logo-img">
            <span class="logo-text">Astral Boutique</span>
        </div>
        <div class="header-icons">
            <div style="position:relative; display:inline-block">
                <i class="fas fa-shopping-bag" onclick="openCart()"></i>
                <span class="cart-count" id="cartCount">0</span>
            </div>
            <i class="fas fa-sliders-h" onclick="openAdmin()"></i>
        </div>
    </header>

    <div class="container">
        <div class="filters" id="categoryFilters"></div>
        <div class="grid" id="productGrid"></div>
    </div>

    <footer id="appFooter">
        <div class="social-icons" id="socialLinksContainer"></div>
        <div class="copyright">&copy; 2024 Astral Boutique.</div>
        <div class="powered-by">Powered by Gabora646</div>
    </footer>

    <div class="modal" id="productModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('productModal')"><i class="fas fa-times"></i></button>
            <div id="modalProductContent"></div>
        </div>
    </div>

    <div class="gallery-modal" id="galleryModal">
        <div class="gallery-close" onclick="closeGallery()">&times;</div>
        <div class="gallery-img-container">
            <img id="galleryImg" class="gallery-img" src="">
        </div>
        <div class="gallery-controls">
            <button class="gallery-btn" onclick="prevGalleryImage()"><i class="fas fa-chevron-left"></i></button>
            <div class="gallery-dots" id="galleryDots"></div>
            <button class="gallery-btn" onclick="nextGalleryImage()"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>

    <div class="modal" id="cartModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('cartModal')"><i class="fas fa-times"></i></button>
            <h2 style="margin-bottom: 20px; color: var(--primary-color);">Tu Bolsa <i class="fas fa-shopping-bag"></i></h2>
            <div id="cartItemsContainer" style="max-height: 50vh; overflow-y: auto;"></div>
            <div style="margin-top: 20px; border-top: 1px solid var(--glass-border); padding-top: 15px;">
                <div style="display: flex; justify-content: space-between; font-size: 1.3rem; font-weight: bold;">
                    <span>Total:</span>
                    <span id="cartTotal" style="color: var(--primary-color)">$0.00</span>
                </div>
                <button class="btn-primary" onclick="openCheckout()">Ir a Pagar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="checkoutModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('checkoutModal')"><i class="fas fa-times"></i></button>
            <h2 style="margin-bottom: 20px; color: var(--primary-color);">Finalizar Pedido</h2>
            <select id="paymentMethod" class="input-glass" onchange="showPaymentInfo()">
                <option value="">M√©todo de Pago...</option>
                <option value="efectivo">üíµ Efectivo</option>
                <option value="transferencia">üè¶ Transferencia Bancaria</option>
                <option value="paypal">üÖøÔ∏è PayPal</option>
                <option value="usdt">üíé USDT (Binance)</option>
            </select>
            <div id="paymentDetails" style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 15px; font-size: 0.85rem; color: #ddd; display: none; border: 1px solid var(--primary-color);"></div>
            <input type="text" id="paymentRef" class="input-glass" placeholder="Referencia / Comprobante">
            <button class="btn-primary" onclick="sendOrderToWhatsapp()"><i class="fab fa-whatsapp"></i> Enviar Pedido</button>
        </div>
    </div>

    <div class="modal" id="adminModal">
        <div class="modal-content" style="max-height: 95vh;">
            <button class="close-modal" onclick="closeModal('adminModal')"><i class="fas fa-times"></i></button>
            <div id="adminLogin" style="text-align: center; padding: 20px;">
                <h2 style="color: var(--primary-color); margin-bottom: 20px;">Admin Access</h2>
                <input type="password" id="adminPass" class="input-glass" placeholder="Contrase√±a">
                <button class="btn-primary" onclick="loginAdmin()">Entrar</button>
            </div>
            
            <div id="adminDashboard" style="display: none;">
                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Panel de Control</h3>
                <div class="admin-tabs">
                    <div class="tab active" onclick="switchAdminTab('products')">Items</div>
                    <div class="tab" onclick="switchAdminTab('add')">Nuevo</div>
                    <div class="tab" onclick="switchAdminTab('design')">Dise√±o</div>
                    <div class="tab" onclick="switchAdminTab('config')">Data</div>
                </div>

                <div id="tab-products" style="display: block;">
                    <div id="adminProductList"></div>
                </div>

                <div id="tab-add" style="display: none;">
                    <input type="hidden" id="editProductId">
                    <div class="upload-area" onclick="document.getElementById('imageUpload').click()">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--text-muted);"></i>
                        <p style="margin-top: 5px; font-size: 0.8rem;">Subir imagen (ImgBB)</p>
                        <input type="file" id="imageUpload" style="display: none;" accept="image/*" onchange="uploadToImgbb(this)">
                        <div id="uploadSpinner" class="upload-spinner"><i class="fas fa-spinner fa-spin"></i> Subiendo...</div>
                    </div>
                    <input type="text" id="prodName" class="input-glass" placeholder="Nombre del art√≠culo">
                    <div style="display:flex; gap:10px;">
                        <input type="number" id="prodPrice" class="input-glass" placeholder="Precio ($)">
                        <select id="prodCategory" class="input-glass" onchange="renderAttributeInputs()">
                            <option value="clothing">Ropa</option>
                            <option value="shoes">Zapatos</option>
                            <option value="perfume">Perfumes</option>
                            <option value="accessories">Accesorios</option>
                            <option value="makeup">Maquillaje</option>
                        </select>
                    </div>
                    <textarea id="prodImages" class="input-glass" rows="2" placeholder="URLs im√°genes (separar con coma)"></textarea>
                    <textarea id="prodDesc" class="input-glass" rows="2" placeholder="Descripci√≥n"></textarea>
                    <div id="dynamicAttributes" style="margin-bottom: 10px;"></div>
                    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                        <label style="display:flex; align-items:center; gap:5px;"><input type="checkbox" id="prodNew" checked> Nuevo</label>
                        <label style="display:flex; align-items:center; gap:5px;"><input type="checkbox" id="prodStock" checked> Stock</label>
                    </div>
                    <button class="btn-primary" onclick="saveProduct()">Guardar</button>
                    <button class="btn-secondary" onclick="clearForm()">Limpiar</button>
                </div>

                <div id="tab-design" style="display: none;">
                    <h4 style="color: white; margin-bottom: 15px;">Personalizar</h4>
                    
                    <div class="color-config-row">
                        <span>Estilo Visual</span>
                        <select id="color-mode" class="input-glass" style="width: auto; margin: 0;">
                            <option value="gradient">Degradado (Mix)</option>
                            <option value="solid">S√≥lido (Plano)</option>
                        </select>
                    </div>

                    <div class="color-config-row">
                        <span>Color Primario</span>
                        <input type="color" id="color-primary" class="color-input" value="#d4af37">
                    </div>
                    <div class="color-config-row">
                        <span>Color Acento</span>
                        <input type="color" id="color-accent" class="color-input" value="#ff007f">
                    </div>
                    <div class="color-config-row">
                        <span>Fondo</span>
                        <input type="color" id="color-bg" class="color-input" value="#050505">
                    </div>
                    <button class="btn-primary" onclick="applyAndSaveTheme()">Aplicar</button>
                    <button class="btn-secondary" onclick="resetTheme()">Restaurar Default</button>
                </div>

                <div id="tab-config" style="display: none;">
                    <h4 style="color: var(--primary-color);">Redes Sociales</h4>
                    <div class="social-config-row">
                        <i class="fab fa-instagram"></i>
                        <input type="text" id="socialInsta" class="input-glass" placeholder="URL Instagram">
                        <input type="checkbox" id="checkInsta">
                    </div>
                    <div class="social-config-row">
                        <i class="fab fa-tiktok"></i>
                        <input type="text" id="socialTiktok" class="input-glass" placeholder="URL TikTok">
                        <input type="checkbox" id="checkTiktok">
                    </div>
                    <div class="social-config-row">
                        <i class="fab fa-facebook-f"></i>
                        <input type="text" id="socialFb" class="input-glass" placeholder="URL Facebook">
                        <input type="checkbox" id="checkFb">
                    </div>
                    
                    <hr style="border-color: var(--glass-border); margin: 20px 0;">
                    
                    <h4 style="color: var(--primary-color);">Credenciales</h4>
                    <input type="text" id="cfgImgbbKey" class="input-glass" placeholder="ImgBB Key">
                    <input type="text" id="cfgBinId" class="input-glass" placeholder="JSONBin ID (Requerido)">
                    <input type="text" id="cfgApiKey" class="input-glass" placeholder="JSONBin Master Key">
                    
                    <hr style="border-color: var(--glass-border); margin: 20px 0;">
                    
                    <h4 style="color: var(--primary-color);">Pagos</h4>
                    <textarea id="cfgPayTransfer" class="input-glass" placeholder="Datos Transferencia"></textarea>
                    <textarea id="cfgPayUsdt" class="input-glass" placeholder="Datos USDT"></textarea>
                    <textarea id="cfgPayPaypal" class="input-glass" placeholder="Datos PayPal"></textarea>
                    
                    <button class="btn-primary" onclick="saveConfig()">Guardar TODO</button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"><i class="fas fa-info-circle"></i> <span>Mensaje</span></div>

    <script>
        // --- ESTADO & CONFIGURACI√ìN INICIAL ---
        let products = [
            // Producto demo inicial
            { 
                id: 1, 
                name: "Luxury Essence", 
                price: 120, 
                category: "perfume", 
                images: ["https://i.ibb.co/6rHT9X0/perfume.jpg"], 
                desc: "Notas de madera.", 
                attributes: { "Volumen": ["100ml"] }, 
                isNew: true, 
                inStock: true 
            }
        ];
        
        let cart = [];
        
        // Tus credenciales configuradas
        let config = {
            binId: localStorage.getItem('butic_binId') || '69658857d0ea881f40678f48',
            apiKey: localStorage.getItem('butic_apiKey') || '$2a$10$dA7EJL7AkWBNkHLyVflDme6uxH4jSuGjdywTiOQuICg9GFJDUWkcK',
            imgbbKey: localStorage.getItem('butic_imgbbKey') || '7faa542847653860ccfec6b581b2fbde',
            
            theme: JSON.parse(localStorage.getItem('butic_theme')) || {
                mode: 'gradient',
                primary: '#d4af37',
                accent: '#ff007f',
                bg: '#050505'
            },
            
            socials: JSON.parse(localStorage.getItem('butic_socials')) || {
                instagram: { url: '', enabled: false },
                tiktok: { url: '', enabled: false },
                facebook: { url: '', enabled: false }
            },
            
            paymentInfo: JSON.parse(localStorage.getItem('butic_paymentInfo')) || {
                transferencia: "Banco: Venezuela\nCuenta: 0102-XXXX\nCI: 12345678",
                usdt: "Red: BEP20 (BSC)\nWallet: 0x...",
                paypal: "pagos@butic.com"
            }
        };

        const adminPhone = "584228745777";

        // --- INICIALIZACI√ìN ---
        document.addEventListener('DOMContentLoaded', () => {
            loadTheme();
            
            // Cargar datos del servidor o locales
            if (config.binId && config.apiKey) {
                fetchData();
            } else {
                renderProducts(products);
                renderCategories();
                renderFooter();
            }
            renderAttributeInputs();
            
            // Rellenar Admin Panel con datos
            document.getElementById('cfgBinId').value = config.binId;
            document.getElementById('cfgApiKey').value = config.apiKey;
            document.getElementById('cfgImgbbKey').value = config.imgbbKey;
            
            document.getElementById('cfgPayTransfer').value = config.paymentInfo.transferencia;
            document.getElementById('cfgPayUsdt').value = config.paymentInfo.usdt;
            document.getElementById('cfgPayPaypal').value = config.paymentInfo.paypal;

            document.getElementById('socialInsta').value = config.socials.instagram.url;
            document.getElementById('checkInsta').checked = config.socials.instagram.enabled;
            document.getElementById('socialTiktok').value = config.socials.tiktok.url;
            document.getElementById('checkTiktok').checked = config.socials.tiktok.enabled;
            document.getElementById('socialFb').value = config.socials.facebook.url;
            document.getElementById('checkFb').checked = config.socials.facebook.enabled;
            
            document.getElementById('color-mode').value = config.theme.mode || 'gradient';
        });

        // --- GALER√çA FULLSCREEN ---
        let galleryImages = [];
        let galleryIndex = 0;

        function openGallery(idx) {
            if(!currentProduct) return;
            galleryImages = currentProduct.images;
            galleryIndex = idx;
            document.getElementById('galleryModal').classList.add('active');
            updateGallery();
        }

        function closeGallery() {
            document.getElementById('galleryModal').classList.remove('active');
        }

        function nextGalleryImage() {
            galleryIndex = (galleryIndex + 1) % galleryImages.length;
            updateGallery();
        }

        function prevGalleryImage() {
            galleryIndex = (galleryIndex - 1 + galleryImages.length) % galleryImages.length;
            updateGallery();
        }
        
        function updateGallery() {
            document.getElementById('galleryImg').src = galleryImages[galleryIndex];
            const dots = document.getElementById('galleryDots');
            dots.innerHTML = '';
            galleryImages.forEach((_, i) => {
                dots.innerHTML += `<div class="dot ${i === galleryIndex ? 'active' : ''}"></div>`;
            });
        }

        // --- RENDERIZADO DE INTERFAZ ---
        function renderCategories() {
            const container = document.getElementById('categoryFilters');
            let html = '<button class="filter-btn active" onclick="filterProducts(\'all\')"><i class="fas fa-th-large"></i> Todo</button>';
            
            // Detectar categor√≠as usadas
            const activeCats = new Set();
            products.forEach(p => {
                if(p.inStock || isAdminMode()) {
                    activeCats.add(p.category);
                }
            });

            // Configuraci√≥n de iconos
            const catConfig = {
                clothing: { label: 'Ropa', icon: 'fa-tshirt' },
                shoes: { label: 'Calzado', icon: 'fa-shoe-prints' },
                perfume: { label: 'Perfumes', icon: 'fa-spray-can' },
                accessories: { label: 'Accesorios', icon: 'fa-gem' },
                makeup: { label: 'Maquillaje', icon: 'fa-magic' }
            };

            activeCats.forEach(cat => {
                const info = catConfig[cat] || { label: cat, icon: 'fa-tag' };
                html += `<button class="filter-btn" onclick="filterProducts('${cat}')"><i class="fas ${info.icon}"></i> ${info.label}</button>`;
            });

            container.innerHTML = html;
        }

        function renderProducts(list) {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = '';
            list.forEach(prod => {
                if(!prod.inStock && !isAdminMode()) return;
                
                const div = document.createElement('div');
                div.className = 'product-card';
                div.onclick = () => openProductModal(prod.id);
                
                const img = prod.images[0] || 'https://via.placeholder.com/300';
                
                div.innerHTML = `
                    ${prod.isNew ? '<div class="badge-new">NEW</div>' : ''}
                    <div class="img-container">
                        <img src="${img}" alt="${prod.name}">
                    </div>
                    <div class="card-info">
                        <div class="card-title">${prod.name}</div>
                        <div class="card-price">$${prod.price}</div>
                    </div>
                `;
                grid.appendChild(div);
            });
        }

        function filterProducts(cat) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            event.target.closest('button').classList.add('active');
            if (cat === 'all') renderProducts(products);
            else renderProducts(products.filter(p => p.category === cat));
        }

        function renderFooter() {
            const container = document.getElementById('socialLinksContainer');
            container.innerHTML = '';
            
            if(config.socials.instagram.enabled) {
                container.innerHTML += `<a href="${config.socials.instagram.url}" target="_blank" class="social-btn"><i class="fab fa-instagram"></i></a>`;
            }
            if(config.socials.tiktok.enabled) {
                container.innerHTML += `<a href="${config.socials.tiktok.url}" target="_blank" class="social-btn"><i class="fab fa-tiktok"></i></a>`;
            }
            if(config.socials.facebook.enabled) {
                container.innerHTML += `<a href="${config.socials.facebook.url}" target="_blank" class="social-btn"><i class="fab fa-facebook-f"></i></a>`;
            }
            
            // Bot√≥n de WhatsApp siempre presente
            container.innerHTML += `<a href="https://wa.me/${adminPhone}" target="_blank" class="social-btn"><i class="fab fa-whatsapp"></i></a>`;
        }

        // --- MOTOR DE TEMAS (COLORES) ---
        function loadTheme() {
            if(config.theme) {
                const r = document.documentElement.style;
                r.setProperty('--primary-color', config.theme.primary);
                r.setProperty('--accent-color', config.theme.accent);
                r.setProperty('--bg-dark', config.theme.bg);
                
                // L√≥gica de modo s√≥lido vs degradado
                if (config.theme.mode === 'solid') {
                    r.setProperty('--dynamic-bg', config.theme.primary);
                    r.setProperty('--dynamic-text', config.theme.primary);
                } else {
                    r.setProperty('--dynamic-bg', `linear-gradient(90deg, ${config.theme.primary}, ${config.theme.accent})`);
                    r.setProperty('--dynamic-text', `linear-gradient(45deg, ${config.theme.primary}, ${config.theme.accent})`);
                }
                
                // Actualizar inputs visualmente
                document.getElementById('color-primary').value = config.theme.primary;
                document.getElementById('color-accent').value = config.theme.accent;
                document.getElementById('color-bg').value = config.theme.bg;
                document.getElementById('color-mode').value = config.theme.mode || 'gradient';
            }
        }

        function applyAndSaveTheme() {
            config.theme = {
                mode: document.getElementById('color-mode').value,
                primary: document.getElementById('color-primary').value,
                accent: document.getElementById('color-accent').value,
                bg: document.getElementById('color-bg').value
            };
            localStorage.setItem('butic_theme', JSON.stringify(config.theme));
            loadTheme();
            saveConfig();
            showToast("üé® Tema actualizado");
        }

        function resetTheme() {
            localStorage.removeItem('butic_theme');
            location.reload();
        }

        // --- MODAL DE PRODUCTO (L√ìGICA) ---
        let currentProduct = null;
        let selectedAttributes = {};

        function openProductModal(id) {
            currentProduct = products.find(p => p.id === id);
            selectedAttributes = {};
            const content = document.getElementById('modalProductContent');
            const img = currentProduct.images.length > 0 ? currentProduct.images[0] : 'https://via.placeholder.com/150';

            let attrsHtml = '';
            for (let [key, values] of Object.entries(currentProduct.attributes)) {
                if(Array.isArray(values) && values.length > 0) {
                    attrsHtml += `
                        <div class="attr-group">
                            <div class="attr-label">${key}</div>
                            <div class="attr-chips-container">
                                ${values.map(val => `<div class="option-chip" onclick="selectAttr('${key}', '${val}', this)">${val}</div>`).join('')}
                            </div>
                        </div>`;
                }
            }

            content.innerHTML = `
                <div class="modal-body-compact">
                    <div class="modal-img-wrapper" onclick="openGallery(0)">
                        <img src="${img}" class="modal-img-compact">
                        <div class="zoom-hint"><i class="fas fa-expand"></i></div>
                    </div>
                    <div class="modal-details-compact">
                        <div class="modal-title">${currentProduct.name}</div>
                        <div class="modal-price">$${currentProduct.price}</div>
                        <div class="modal-desc">${currentProduct.desc}</div>
                    </div>
                </div>
                ${attrsHtml}
                <button class="btn-primary" onclick="addToCartLogic()">A√±adir a la Bolsa</button>
            `;
            document.getElementById('productModal').classList.add('active');
        }

        function selectAttr(key, val, el) {
            selectedAttributes[key] = val;
            Array.from(el.parentElement.children).forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
        }

        // --- CARRITO & CHECKOUT ---
        function addToCartLogic() {
            const reqAttrs = Object.keys(currentProduct.attributes);
            for(let req of reqAttrs) {
                if(currentProduct.attributes[req].length > 0 && !selectedAttributes[req]) {
                    showToast(`‚ö†Ô∏è Selecciona: ${req}`);
                    return;
                }
            }
            cart.push({ ...currentProduct, selectedAttrs: {...selectedAttributes}, cartId: Date.now(), qty: 1 });
            updateCartUI();
            closeModal('productModal');
            showToast("üõçÔ∏è A√±adido");
        }

        function updateCartUI() {
            document.getElementById('cartCount').innerText = cart.reduce((acc, item) => acc + item.qty, 0);
            const container = document.getElementById('cartItemsContainer');
            container.innerHTML = '';
            let total = 0;

            cart.forEach((item, index) => {
                total += item.price * item.qty;
                container.innerHTML += `
                    <div style="display:flex; gap:15px; margin-bottom:15px; background:rgba(255,255,255,0.03); padding:10px; border-radius:10px; align-items:center">
                        <img src="${item.images[0]}" style="width:50px; height:50px; border-radius:8px; object-fit:cover">
                        <div style="flex:1">
                            <div style="font-weight:600; font-size:0.9rem">${item.name}</div>
                            <div style="font-size:0.75rem; color:#888">${Object.values(item.selectedAttrs).join(', ')}</div>
                            <div style="color:var(--primary-color)">$${item.price}</div>
                        </div>
                         <i class="fas fa-trash" style="color:var(--accent-color); cursor:pointer" onclick="cart.splice(${index}, 1); updateCartUI()"></i>
                    </div>`;
            });
            document.getElementById('cartTotal').innerText = `$${total.toFixed(2)}`;
        }

        function openCart() {
            if(cart.length === 0) return showToast("Bolsa vac√≠a");
            document.getElementById('cartModal').classList.add('active');
        }

        function openCheckout() {
            closeModal('cartModal');
            document.getElementById('checkoutModal').classList.add('active');
        }

        function showPaymentInfo() {
            const method = document.getElementById('paymentMethod').value;
            const detailsDiv = document.getElementById('paymentDetails');
            if(!method) { detailsDiv.style.display = 'none'; return; }
            
            const infoMap = {
                efectivo: "Pago al momento de la entrega.",
                transferencia: config.paymentInfo.transferencia,
                paypal: config.paymentInfo.paypal,
                usdt: config.paymentInfo.usdt
            };
            
            detailsDiv.innerHTML = `<pre style="white-space:pre-wrap; font-family:inherit; margin:0">${infoMap[method]}</pre>`;
            detailsDiv.style.display = 'block';
        }

        function sendOrderToWhatsapp() {
            const method = document.getElementById('paymentMethod').value;
            const ref = document.getElementById('paymentRef').value;
            if(!method) return showToast("Selecciona pago");
            
            let msg = `*PEDIDO WEB - ASTRAL*\n----------------\n`;
            cart.forEach(i => msg += `‚ñ™ ${i.name} (${Object.values(i.selectedAttrs).join('/')}) x${i.qty}\n`);
            msg += `\n*TOTAL: ${document.getElementById('cartTotal').innerText}*\n`;
            msg += `Pago: ${method.toUpperCase()}\nRef: ${ref || 'Pendiente'}\nID: ${Date.now().toString().slice(-4)}`;
            
            window.open(`https://wa.me/${adminPhone}?text=${encodeURIComponent(msg)}`, '_blank');
            cart = []; updateCartUI(); closeModal('checkoutModal');
        }

        // --- CONEXIONES API (IMGBB + JSONBIN) ---
        async function uploadToImgbb(input) {
            const file = input.files[0];
            if (!file) return;
            const apiKey = document.getElementById('cfgImgbbKey').value;
            
            if(!apiKey) return alert("Primero configura tu API Key de ImgBB");

            document.getElementById('uploadSpinner').style.display = 'block';
            const formData = new FormData();
            formData.append("image", file);

            try {
                const res = await fetch(`https://api.imgbb.com/1/upload?key=${apiKey}`, { method: "POST", body: formData });
                const data = await res.json();
                if (data.success) {
                    const currentUrls = document.getElementById('prodImages').value;
                    const separator = currentUrls.length > 0 ? ', ' : '';
                    document.getElementById('prodImages').value += separator + data.data.url;
                    showToast("‚úÖ Imagen subida");
                } else showToast("‚ùå Error al subir");
            } catch (error) { showToast("‚ùå Error de red"); } 
            finally { document.getElementById('uploadSpinner').style.display = 'none'; }
        }

        async function fetchData() {
            showToast("üîÑ Sincronizando...");
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${config.binId}/latest`, { 
                    headers: { 'X-Master-Key': config.apiKey } 
                });
                if(res.ok) {
                    const data = await res.json();
                    
                    // Actualizar estado local
                    if(data.record.products) products = data.record.products;
                    if(data.record.paymentInfo) config.paymentInfo = data.record.paymentInfo;
                    if(data.record.socials) config.socials = data.record.socials;
                    if(data.record.theme) { config.theme = data.record.theme; loadTheme(); }
                    
                    // Refrescar UI
                    renderProducts(products);
                    renderCategories();
                    renderFooter();
                }
            } catch (e) { showToast("‚ö†Ô∏è Usando datos locales"); }
        }

        function saveConfig() {
            // Capturar valores del DOM
            config.binId = document.getElementById('cfgBinId').value;
            config.apiKey = document.getElementById('cfgApiKey').value;
            config.imgbbKey = document.getElementById('cfgImgbbKey').value;
            
            config.paymentInfo = {
                transferencia: document.getElementById('cfgPayTransfer').value,
                usdt: document.getElementById('cfgPayUsdt').value,
                paypal: document.getElementById('cfgPayPaypal').value
            };

            config.socials = {
                instagram: { url: document.getElementById('socialInsta').value, enabled: document.getElementById('checkInsta').checked },
                tiktok: { url: document.getElementById('socialTiktok').value, enabled: document.getElementById('checkTiktok').checked },
                facebook: { url: document.getElementById('socialFb').value, enabled: document.getElementById('checkFb').checked }
            };

            // Guardar local
            localStorage.setItem('butic_binId', config.binId);
            localStorage.setItem('butic_apiKey', config.apiKey);
            localStorage.setItem('butic_imgbbKey', config.imgbbKey);
            localStorage.setItem('butic_paymentInfo', JSON.stringify(config.paymentInfo));
            localStorage.setItem('butic_socials', JSON.stringify(config.socials));

            // Guardar nube
            saveDataToCloud();
            renderFooter();
            showToast("‚úÖ Datos Guardados");
        }

        async function saveDataToCloud() {
            if (!config.binId || !config.apiKey) return;
            try {
                await fetch(`https://api.jsonbin.io/v3/b/${config.binId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json', 'X-Master-Key': config.apiKey },
                    body: JSON.stringify({ 
                        products: products, 
                        paymentInfo: config.paymentInfo, 
                        theme: config.theme, 
                        socials: config.socials 
                    })
                });
            } catch (e) { console.error("Error guardando en nube"); }
        }

        // --- FUNCIONES PANEL ADMIN ---
        function openAdmin() { document.getElementById('adminModal').classList.add('active'); }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }
        function isAdminMode() { return document.getElementById('adminDashboard').style.display === 'block'; }
        
        function loginAdmin() {
            if(document.getElementById('adminPass').value === "System32") {
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                renderAdminProducts();
                renderCategories(); // Forzar render por si hay items ocultos que el admin debe ver
                renderProducts(products); 
            } else showToast("Contrase√±a incorrecta");
        }

        function switchAdminTab(t) {
            document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
            event.target.classList.add('active');
            ['products', 'add', 'config', 'design'].forEach(x => document.getElementById('tab-'+x).style.display = (x===t)?'block':'none');
        }

        function renderAdminProducts() {
            const list = document.getElementById('adminProductList');
            list.innerHTML = '';
            products.forEach(p => {
                list.innerHTML += `
                    <div style="display:flex; justify-content:space-between; padding:10px; background:rgba(255,255,255,0.05); margin-bottom:5px; border-radius:8px">
                        <span style="color:${p.inStock?'white':'red'}">${p.name} ($${p.price})</span>
                        <div>
                            <i class="fas fa-edit" style="color:var(--primary-color); margin-right:10px; cursor:pointer" onclick="editProduct(${p.id})"></i>
                            <i class="fas fa-trash" style="color:var(--accent-color); cursor:pointer" onclick="deleteProduct(${p.id})"></i>
                        </div>
                    </div>`;
            });
        }

        function renderAttributeInputs(preset=null) {
            const cat = document.getElementById('prodCategory').value;
            const container = document.getElementById('dynamicAttributes');
            container.innerHTML = '';
            
            const mappings = {
                clothing: ['Talla'], 
                shoes: ['Talla', 'Horma'], 
                perfume: ['Volumen'],
                makeup: ['Tono'], 
                accessories: ['Color']
            };
            
            (mappings[cat] || ['Opci√≥n']).forEach(key => {
                const val = preset && preset[key] ? preset[key].join(', ') : '';
                container.innerHTML += `<input type="text" class="input-glass attr-input" data-key="${key}" placeholder="${key} (sep. por comas)" value="${val}">`;
            });
        }

        function saveProduct() {
            const id = document.getElementById('editProductId').value;
            const name = document.getElementById('prodName').value;
            const price = parseFloat(document.getElementById('prodPrice').value);
            const category = document.getElementById('prodCategory').value;
            const imagesRaw = document.getElementById('prodImages').value;
            
            if(!name || !price) return showToast("Faltan datos");

            let attrs = {};
            document.querySelectorAll('.attr-input').forEach(i => {
                const val = i.value.split(',').map(s=>s.trim()).filter(s=>s!=='');
                if(val.length) attrs[i.dataset.key] = val;
            });

            const newProd = {
                id: id ? parseInt(id) : Date.now(),
                name, price, category, 
                images: imagesRaw.split(',').map(s=>s.trim()).filter(s=>s!==''),
                desc: document.getElementById('prodDesc').value,
                attributes: attrs,
                isNew: document.getElementById('prodNew').checked,
                inStock: document.getElementById('prodStock').checked
            };

            if(id) products[products.findIndex(p=>p.id==id)] = newProd;
            else products.push(newProd);

            saveDataToCloud();
            clearForm();
            switchAdminTab('products');
            renderAdminProducts();
            renderCategories();
            renderProducts(products);
        }

        function editProduct(id) {
            const p = products.find(x => x.id === id);
            document.getElementById('editProductId').value = p.id;
            document.getElementById('prodName').value = p.name;
            document.getElementById('prodPrice').value = p.price;
            document.getElementById('prodCategory').value = p.category;
            document.getElementById('prodImages').value = p.images.join(', ');
            document.getElementById('prodDesc').value = p.desc;
            document.getElementById('prodNew').checked = p.isNew;
            document.getElementById('prodStock').checked = p.inStock;
            renderAttributeInputs(p.attributes);
            switchAdminTab('add');
        }

        function deleteProduct(id) {
            if(confirm("¬øEliminar?")) {
                products = products.filter(p => p.id !== id);
                saveDataToCloud();
                renderAdminProducts();
                renderCategories();
                renderProducts(products);
            }
        }

        function clearForm() {
            document.getElementById('editProductId').value = '';
            document.querySelectorAll('#tab-add input:not([type=checkbox]):not([type=file]), #tab-add textarea').forEach(i => i.value='');
            renderAttributeInputs();
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.querySelector('span').innerText = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        }
    </script>
</body>
</html>
